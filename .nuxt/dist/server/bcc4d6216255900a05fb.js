exports.ids=[1],exports.modules={116:function(t,e,r){"use strict";var o={props:{src:{type:String,default:""},height:{type:String,default:"30"}},data:()=>({error:!1})},l=r(3),component=Object(l.a)(o,function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.error?r("svg",{attrs:{viewBox:"64 64 896 896","data-icon":"dollar",width:t.height,height:t.height,fill:"currentColor","aria-hidden":"true"}},[t._ssrNode('<path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm47.7-395.2l-25.4-5.9V348.6c38 5.2 61.5 29 65.5 58.2.5 4 3.9 6.9 7.9 6.9h44.9c4.7 0 8.4-4.1 8-8.8-6.1-62.3-57.4-102.3-125.9-109.2V263c0-4.4-3.6-8-8-8h-28.1c-4.4 0-8 3.6-8 8v33c-70.8 6.9-126.2 46-126.2 119 0 67.6 49.8 100.2 102.1 112.7l24.7 6.3v142.7c-44.2-5.9-69-29.5-74.1-61.3-.6-3.8-4-6.6-7.9-6.6H363c-4.7 0-8.4 4-8 8.7 4.5 55 46.2 105.6 135.2 112.1V761c0 4.4 3.6 8 8 8h28.4c4.4 0 8-3.6 8-8.1l-.2-31.7c78.3-6.9 134.3-48.8 134.3-124-.1-69.4-44.2-100.4-109-116.4zm-68.6-16.2c-5.6-1.6-10.3-3.1-15-5-33.8-12.2-49.5-31.9-49.5-57.3 0-36.3 27.5-57 64.5-61.7v124zM534.3 677V543.3c3.1.9 5.9 1.6 8.8 2.2 47.3 14.4 63.2 34.4 63.2 65.1 0 39.1-29.4 62.6-72 66.4z"></path>')]):r("img",{attrs:{src:t.src,height:t.height},on:{error:function(e){t.error=!0}}})},[],!1,null,null,"6d94845a");e.a=component.exports},118:function(t,e,r){var content=r(123);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);var o=r(5).default;t.exports.__inject__=function(t){o("6490923b",content,!0,t)}},119:function(t,e,r){var content=r(125);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);var o=r(5).default;t.exports.__inject__=function(t){o("36873827",content,!0,t)}},122:function(t,e,r){"use strict";r.r(e);var o=r(118),l=r.n(o);for(var n in o)"default"!==n&&function(t){r.d(e,t,function(){return o[t]})}(n);e.default=l.a},123:function(t,e,r){(t.exports=r(4)(!1)).push([t.i,".el-form[data-v-4c9e9830]{padding:10px 70px}.upperinput[data-v-4c9e9830]{text-transform:uppercase}.upperinput[data-v-4c9e9830]:placeholder-shown{text-transform:none}",""])},124:function(t,e,r){"use strict";r.r(e);var o=r(119),l=r.n(o);for(var n in o)"default"!==n&&function(t){r.d(e,t,function(){return o[t]})}(n);e.default=l.a},125:function(t,e,r){(t.exports=r(4)(!1)).push([t.i,".order-row{cursor:pointer}.market-row{display:flex;align-items:center}",""])},127:function(t,e,r){"use strict";r.r(e);r(23);var o=r(10),l=r(9),n=r(1),c=r(116),m=r(18),d={components:{TokenImage:c.a},data(){return{visible:!1,tokens:[],sellSelect:"",form:{sell:{symbol:"",contract:"",amount:0},buy:{symbol:"",contract:"",amount:1}},rules:{"buy.contract":{trigger:"blur",validator:async(t,e,r)=>{try{await this.rpc.get_account(e),r()}catch(t){r(new Error("Account not exists"))}}},"buy.symbol":{trigger:"blur",validator:async(t,e,r)=>{e in await this.rpc.get_currency_stats(this.form.buy.contract,e)?(r(),this.setBuyToken({contract:this.form.buy.contract,symbol:e})):r(new Error(`No ${e} symbol in ${this.form.buy.contract} contract`))}}},formLabelWidth:"120px",tokenSelect:""}},computed:{...Object(l.mapGetters)(["user"]),...Object(l.mapGetters)("chain",["rpc"]),wrongPrice(){return 0!=this.form.sell.amount&&0!=this.form.buy.amount&&Object(m.a)(this.form.buy.amount,4)*n.a.PRICE_SCALE%Object(m.a)(this.form.sell.amount,this.form.sell.precision)!=0},sellTokens(){if(this.user.balances)return this.user.balances.filter(b=>"EOS"!==b.currency)},price(){return Object(m.b)(this.form.sell,this.form.buy)}},created(){this.fetchTokens()},methods:{sellSellToken(t){this.form.sell={symbol:t.currency,contract:t.contract,precision:parseInt(t.decimals),maxAmount:parseFloat(t.amount),amount:0}},async setBuyToken(t){let e=4;try{const{rows:[r]}=await this.rpc.get_table_rows({code:t.contract,scope:t.symbol,table:"stat"});e=r.max_supply.split(" ")[0].split(".")[1].length}catch(e){Object(o.captureException)(e,{extra:{token:t}}),this.$notify({title:"Fetch token",message:e.message,type:"warning"}),console.log(e)}this.form.buy={symbol:t.symbol,contract:t.contract,amount:0,precision:e}},open(){this.user?this.visible=!0:this.$notify({title:"Login",message:"Pleace login first",type:"info"})},fetchTokens(){const t=new WebSocket("wss://api-v1.eosflare.io/socket.io/?EIO=3&transport=websocket");t.addEventListener("open",e=>{t.addEventListener("message",t=>{42==t.data.substr(0,2)&&(this.tokens=JSON.parse(JSON.parse(t.data.substr(2))[1]).tokens,this.tokens.sort((a,b)=>a.symbol<b.symbol?-1:a.symbol>b.symbol?1:0),this.tokens.map(b=>b.id=b.symbol+"@"+b.contract))}),t.send('42["message", {"_url":"/chain/get_tokens","_method":"POST","_headers":{"content-type":"application/json"},"page":0,"limit":500,"lang":"en-US"}]')})},submit(){const form={...this.form};form.sell.quantity=`${form.sell.amount.toFixed(form.sell.precision)} ${form.sell.symbol}`,form.buy.quantity=`${form.buy.amount.toFixed(4)} EOS@eosio.token`,this.$confirm(`Are you sure you want to sell ${form.sell.quantity} for ${form.buy.quantity}`,"Sell",{confirmButtonText:"Sell",cancelButtonText:"Cancel",type:"warning"}).then(()=>{this.$emit("submit",form),this.visible=!1}).catch(()=>{})}}},h=r(3);var f=Object(h.a)(d,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-button",{staticClass:"ml-auto",attrs:{size:"medium",type:"primary"},on:{click:t.open}},[r("span",[t._t("default")],2)]),t.user?r("el-dialog",{attrs:{title:"Open new market or create new order for existing market",visible:t.visible,width:"50%"},on:{"update:visible":function(e){t.visible=e}}},[r("el-form",{ref:"form",staticClass:"mt-2",attrs:{model:t.form,"label-position":"left",rules:t.rules}},[r("h1",{staticClass:"leader"},[t._v("Sell")]),r("el-form-item",{attrs:{label:"Sell token"}},[r("el-select",{staticClass:"w-100",attrs:{"value-key":"id",filterable:"",clearable:"",placeholder:"Sell token"},on:{change:t.sellSellToken},model:{value:t.tokenSelect,callback:function(e){t.tokenSelect=e},expression:"tokenSelect"}},t._l(t.sellTokens,function(b){return r("el-option",{key:b.id,attrs:{value:b,label:b.id+" ->  "+b.amount+" "+b.currency}},[r("TokenImage",{attrs:{src:t.$tokenLogo(b.currency,b.contract),height:"25"}}),r("span",{staticClass:"ml-3"},[t._v(t._s(b.id))]),r("span",{staticClass:"float-right"},[t._v(t._s(b.amount+" "+b.currency))])],1)}),1)],1),t.tokenSelect?r("el-form-item",{staticClass:"mt-2"},[r("el-form-item",[t._t("label",[r("TokenImage",{attrs:{src:t.$tokenLogo(this.form.sell.symbol,this.form.sell.contract),height:"50"}}),r("span",{staticClass:"ml-2"},[t._v("Token Amount")])])],2),r("el-input-number",{staticClass:"mt-2 w-100",attrs:{max:t.form.sell.maxAmount,precision:t.form.sell.precision,step:1},model:{value:t.form.sell.amount,callback:function(e){t.$set(t.form.sell,"amount",e)},expression:"form.sell.amount"}})],1):t._e(),t.form.sell.amount>0?r("div",[r("hr"),r("h1",{staticClass:"leader"},[t._v("Buy")]),r("hr"),r("el-form-item",[t._t("label",[r("TokenImage",{attrs:{src:t.$tokenLogo("EOS","eosio.token"),height:"50"}}),r("span",[t._v("EOS Amount")])]),r("el-input-number",{staticClass:"mt-2 w-100",attrs:{precision:4,step:1},model:{value:t.form.buy.amount,callback:function(e){t.$set(t.form.buy,"amount",e)},expression:"form.buy.amount"}},[r("span",{staticClass:"mr-1",attrs:{slot:"suffix"},slot:"suffix"},[t._v("EOS")])]),r("div",{staticClass:"lead mt-2"},[t._v("Price: "+t._s(t.price))])],2),r("el-alert",{directives:[{name:"show",rawName:"v-show",value:t.wrongPrice,expression:"wrongPrice"}],staticClass:"mb-2",attrs:{title:"Amount does not match unit price!",type:"info","show-icon":"",closable:!1}},[t._v("Please change price or amount."),r("a",{staticClass:"ml-1",attrs:{href:"#"},on:{click:t.unitPriceInfo}},[t._v(" WTF ?")])]),r("span",{staticClass:"dialog-footer"},[t.form.buy.amount>0?r("el-button",{staticClass:"w-100",attrs:{type:"primary",disabled:t.wrongPrice},on:{click:t.submit}},[t._v("Create order")]):t._e()],1)],1):t._e()],1)],1):t._e()],1)},[],!1,function(t){var e=r(122);e.__inject__&&e.__inject__(t)},"4c9e9830","c660d2fc").exports,y={components:{TokenImage:c.a},props:{token:{type:Object,default:()=>{}}}},k=Object(h.a)(y,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-popover",{attrs:{placement:"top-start",trigger:"hover"}},[r("div",{attrs:{slot:"reference"},slot:"reference"},[r("TokenImage",{attrs:{slot:"reference",src:t.$tokenLogo(t.token.quantity.split(" ")[1],t.token.contract),height:"25"},slot:"reference"}),r("span",{staticClass:"ml-2"},[t._v(t._s(t.token.quantity))])],1),r("span",{staticClass:"ml-2"},[t._v(t._s(t.token.quantity)+"@"),r("a",{attrs:{href:"https://eosflare.io/token/"+t.token.contract+"/"+t.token.quantity.split(" ")[1],target:"_blank"}},[t._v(t._s(t.token.contract))])])])},[],!1,null,null,"a9f72256").exports,_={components:{TokenImage:c.a,ShortToken:k},data:()=>({history:[]}),computed:{...Object(l.mapGetters)(["user"]),...Object(l.mapGetters)("chain",["rpc"])},created(){this.fetch()},methods:{async fetch(){let t;for(this.history=[];;){let e;try{(e=await this.rpc.get_table_rows({code:n.a.contract,scope:n.a.contract,table:"results",reverse:!0,upper_bound:t})).rows.map(t=>{const e=new Date(1e3*t.time).toLocaleString().split(":");t.time=e[0]+":"+e[1]+":"+e[2],t.sell=Object(m.c)(t.sell),t.buy=Object(m.c)(t.buy),t.price=Object(m.b)(t.sell,t.buy),t.buy.amount/=.9975,t.sell.amount/=.9975}),this.history=[...this.history,...e.rows]}catch(t){this.$notify({title:"Load history",message:t.message,type:"error"});break}finally{this.loading=!1}if(!(e.rows.length>1))break;if((t=e.rows[e.rows.length-1].id-1)<0)break}}}},v=Object(h.a)(_,function(){var t=this.$createElement,e=this._self._c||t;return e("el-table",{staticStyle:{width:"100%"},attrs:{data:this.history,"row-key":"block_num'"}},[e("el-table-column",{attrs:{prop:"maker",label:"Seller",width:"125"}}),e("el-table-column",{attrs:{prop:"buyer",label:"Buyer",width:"125"}}),e("el-table-column",{attrs:{label:"Sell",width:"200"},scopedSlots:this._u([{key:"default",fn:function(t){return[e("ShortToken",{attrs:{token:t.row.sell}})]}}])}),e("el-table-column",{attrs:{label:"Buy",width:"200"},scopedSlots:this._u([{key:"default",fn:function(t){return[e("ShortToken",{attrs:{token:t.row.buy}})]}}])}),e("el-table-column",{attrs:{prop:"time",label:"Time"}}),e("el-table-column",{attrs:{prop:"price",label:"Price"}})],1)},[],!1,null,null,"a0f19e98").exports,w=r(8),C=r(33),x={components:{NewOrderForm:f,History:v,TokenImage:c.a},data:()=>({app_name:n.a.APP_NAME,markets:[],search:"",to_assets:[],select:{from:"",to:""},loading:!0}),computed:{...Object(l.mapGetters)(["user"]),...Object(l.mapGetters)("chain",["rpc"]),filteredItems(){return this.markets.filter(i=>{if(i.token.str.toLowerCase().includes(this.search.toLowerCase()))return!0})}},async created(){await this.fetch(),this.fetchMarketStatistics()},methods:{fetchMarketStatistics(){for(let t of this.markets)Promise.all([Object(w.b)(t.id),Object(w.c)(t.id)]).then(([e,r])=>{if(e.length)t.price=e.sort(m.e)[0].unit_price;else{if(!r.length)return;t.price=r.sort(m.e)[r.length-1].unit_price}t.price=this.$options.filters.humanFloat(t.price)+" EOS"})},clickOrder(a){this.$router.push({name:"trade-id",params:{id:a.id}})},async newOrder({buy:t,sell:e}){const r=this.$loading({lock:!0,text:"Wait for Scatter"});try{const l=await Object(C.transfer)(e.contract,this.user.name,e.quantity,`${t.quantity}`);this.fetch(),this.$notify({title:"Place order",message:l.processed.action_traces[0].inline_traces[1].console,type:"success"})}catch(r){Object(o.captureException)(r,{extra:{buy:t,sell:e}}),this.$notify({title:"Place order",message:r.message,type:"error"}),console.log(r)}finally{r.close()}},async fetch(){let t;for(this.loading=!0,this.markets=[];;){let e=[];try{(e=(await this.rpc.get_table_rows({code:n.a.contract,scope:n.a.contract,table:"markets",reverse:!0,upper_bound:t})).rows).map(t=>{t.token=Object(m.d)(t.token),t.price="0.0000 EOS"}),this.markets=[...this.markets,...e]}catch(t){Object(o.captureException)(t),this.$notify({title:"Load markets",message:t.message,type:"error"});break}finally{this.loading=!1}if(!(e.length>1))break;if((t=e[e.length-1].id-1)<0)break}}}};var S=Object(h.a)(x,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-tabs",{staticClass:"mt-4",attrs:{type:"border-card"}},[r("el-tab-pane",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{label:"Markets"}},[r("div",{staticClass:"el-row"},[r("div",{staticClass:"el-col"},[r("div",{staticClass:"d-flex"},[t.user?r("new-order-form",{staticClass:"mr-2",on:{submit:t.newOrder}},[t._v("New order")]):t._e(),r("el-input",{staticClass:"ml-2 mr-4",attrs:{size:"small",placeholder:"Filter by token"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)])]),r("div",{staticClass:"el-row"},[r("div",{staticClass:"el-col"},[r("el-table",{attrs:{data:t.filteredItems,"row-class-name":"order-row"},on:{"row-click":t.clickOrder}},[r("el-table-column",{attrs:{label:"ID",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("nuxt-link",{staticStyle:{"margin-left":"10px"},attrs:{to:{name:"trade-id",params:{id:e.row.id}}}},[t._v(t._s(e.row.id))])]}}])}),r("el-table-column",{attrs:{label:"Token"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",{staticClass:"name-wrapper market-row",attrs:{slot:"reference"},slot:"reference"},[r("TokenImage",{attrs:{src:t.$tokenLogo(e.row.token.symbol,e.row.token.contract),height:"50"}}),"EOS"==e.row.token.symbol&&"eosio.token"!=e.row.token.contract?r("span",{staticClass:"ml-2"},[r("el-tooltip",{attrs:{effect:"dark",content:'This is not "EOS" system token, be careful',placement:"top"}},[r("el-tag",{attrs:{type:"danger"}},[t._v(t._s(e.row.token.quantity)+"@"+t._s(e.row.token.contract))])],1)],1):r("span",{staticClass:"ml-2 display-4"},[t._v(t._s(e.row.token.symbol.name)+"@"+t._s(e.row.token.contract))])],1)]}}])}),r("el-table-column",{attrs:{label:"Price (EOS)",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",{staticClass:"text-mutted"},[t._v(t._s(e.row.price))])]}}])})],1)],1)])]),r("el-tab-pane",{attrs:{label:"Rules & Information"}},[r("h2",{staticClass:"lead ml-3 mt-3"},[t._v("With "+t._s(t.app_name)+" you can trade any EOS.IO tokens for system EOS tokens,atomically, without the participation of third parties! The tokens should comply with the\nstandard eosio.token of the contract.")]),r("h4",{staticClass:"ml-3 mt-3"},[t._v("Properties:"),r("ul",{staticClass:"mt-1"},[r("li",{staticClass:"lead"},[t._v("Fully onchain matching for limit/market trades.")]),r("li",{staticClass:"lead"},[t._v("All the logic of order storage and matching takes place in the contract's ram, without any additional centralized solutions.")]),r("li",{staticClass:"lead"},[t._v("This application works without centralized back-end and uses only the public EOS node.")]),r("li",{staticClass:"lead"},[r("b",[t._v("No commission at all")]),t._v(" for beta testing time.")])])]),r("h4",{staticClass:"ml-3"},[t._v("Roadmap:"),r("ul",{staticClass:"mt-1"},[r("li",{staticClass:"lead"},[t._v("Global redesign of the application.")]),r("li",{staticClass:"lead"},[t._v("The web application will be published in open source. And contract later.")]),r("li",{staticClass:"lead"},[t._v("Development of additional services for easy search, sorting and working with orders.")])])]),r("h4",{staticClass:"ml-3"},[t._v("Audit:"),r("ul",{staticClass:"mt-1"},[r("li",{staticClass:"lead"},[t._v("Exchange contract:"),r("a",{attrs:{href:t._f("monitorAccount")("eosdex"),target:"_blank"}},[t._v("wwweosswapio")])])])])]),r("el-tab-pane",{staticClass:"p-3",attrs:{label:"Partners"}},[r("div",{staticClass:"lead mb-4"},[t._v("Friends and partners of the project. By any collaborations you can send your suggestions to telegram chat!")]),r("hr"),r("div",{staticClass:"d-flex"},[r("a",{staticClass:"btn",attrs:{href:"https://eosnameswaps.com",target:"_blank"}},[r("div",{staticClass:"d-flex align-items-center span"},[r("img",{staticClass:"mr-3",attrs:{src:"https://www.eosnameswaps.com/images/ens_logo.jpg",height:"80"}}),r("div",{staticClass:"lead"},[t._v("A decentralized EOS account exchange.")])])])])])],1)],1)},[],!1,function(t){var e=r(124);e.__inject__&&e.__inject__(t)},null,"0be797de");e.default=S.exports}};
//# sourceMappingURL=bcc4d6216255900a05fb.js.map